// Generated by CoffeeScript 1.9.2
(function() {
  var app, bodyParser, conf, express, middleware, routes, server, session;

  conf = require('./config');

  express = require('express');

  bodyParser = require('body-parser');

  session = require('cookie-session');

  routes = require('./routes');

  middleware = require('./middleware');

  app = express();

  app.use(bodyParser.json());

  app.use(middleware.authHack);

  app.use(session({
    secret: conf.SECRET_KEY,
    name: 'express_sess'
  }));

  app.use(middleware.systemAuth);

  app.use(middleware.ensureAuthenticated);

  app.use(middleware.ensureActive);

  app.use(middleware.couch);

  routes(app);

  server = app.listen(5000, function() {
    var host, port;
    host = server.address().address;
    port = server.address().port;
    return console.log('app listening at http://%s:%s', host, port);
  });

}).call(this);
